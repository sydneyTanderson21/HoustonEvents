version: "2" # docker compose version

services:
  # frontend:
  #   container_name: houstonevents-frontend
  #   image: houstonevents-frontend-image
  #   restart: unless-stopped # What to do if container crashes
  #   build: # path to dockerfile
  #     context: ./frontend
  #     dockerfile: Dockerfile
  #   ports: # binds local port to container port 
  #     - 80:80 # hosting port : container port 
  nginx: 
    restart: unless-stopped
    build:
        context: ./frontend
        dockerfile: Dockerfile
    ports:
        - 80:80
    volumes:
        - static_volume:/backend/backend/server/static
        - ./frontend/nginx/dev:/etc/nginx/conf.d
    depends_on: 
        - backend
  backend:
    restart: unless-stopped
    build:
        context: ./backend
        dockerfile: Dockerfile
    entrypoint: /backend/docker/backend/wsgi-entrypoint.sh
    volumes:
        - static_volume:/backend/backend/server/static
    ports:
        - 8000:8000
    env_file:
      - ./backend/.env        

volumes:
    static_volume: {}
  